<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
<meta name="title" content="Static site generation | Tome" />
<meta name="twitter:card" content="summary_large_image" />
<link rel="canonical" href="https://tome.fyi/docs/technical/static" />
<meta name="twitter:title" content="Static site generation" />
<meta name="twitter:description" content="The static site generator included with Tome uses internal request handling and concurrency to ensure that pages are exported as quickly as possible.

The static site generation flow works like:" />
<meta name="description" content="The static site generator included with Tome uses internal request handling and concurrency to ensure that pages are exported as quickly as possible.

The static site generation flow works like:" />
<meta name="twitter:creator:id" content="@DrupalSAM" />
<meta name="twitter:creator" content="@DrupalSAM" />
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="/themes/custom/tomefyi/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="revision" href="/docs/technical/static" />
<link rel="prev" href="/docs/technical/importer" />
<link rel="up" href="/docs/technical" />
<link rel="next" href="/docs/hosting" />

    <title>Static site generation | Tome</title>
    <link rel="stylesheet" href="/sites/default/files/css/css_g2p7Z2eoAEvJDXxOywmjX0rHkBNHWowZXrBfVVO_xY8.css?pd0vys" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_vvvp_1xxq4sVlrJjxhk4EUMKQyw_oJdxbO40beBqvPU.css?pd0vys" media="all" />
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:900i|Rubik" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_nS_MJliQn2kMoEe8HX1TCBkuIoTp6m8x7b_il6EUnu8.css?pd0vys" media="all" />

    
<!--[if lte IE 8]>
<script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->

  </head>
  <body class="path-node page-node-type-book">
        <a href="#main-content" class="visually-hidden focusable skip-link">
      Skip to main content
    </a>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    <div class="page page-node-book">

      <header>
        <div class="region region-header">
    <div id="block-sitebranding" class="block block-system block-system-branding-block">
  
    
        <a href="/" title="Home" rel="home" class="site-logo">
      <img src="/themes/custom/tomefyi/logo.svg" alt="Home" />
    </a>
      </div>

  </div>

    </header>
  
  <main role="main">
    <a id="main-content" tabindex="-1"></a>

          <aside class="sidebar" role="complementary">
          <div class="region region-sidebar">
    <div id="block-expandedbooknavigation" class="block block-tfyi-book block-expanded-book-navigation">
  
    
        <nav id="book-block-menu-1" class="book-block-menu" role="navigation" aria-label="Book outline for Documentation">
    
              <a class="burger" href="#">&#9776; Navigation</a>
      <ul  class="menu burger-menu">
                    <li class="menu-item menu-item--expanded">
        <a href="/docs" hreflang="en">Documentation</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/getting-started" hreflang="en">Getting started</a>
              </li>
                <li class="menu-item">
        <a href="/docs/using-the-command-line" hreflang="en">Using the command line</a>
              </li>
                <li class="menu-item">
        <a href="/docs/module-compatibility" hreflang="en">Module compatibility</a>
              </li>
                <li class="menu-item menu-item--expanded">
        <a href="/docs/technical" hreflang="en">Technical documentation</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/technical/exporter" hreflang="en">Exporting</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/importer" hreflang="en">Importing</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/static" hreflang="en">Static site generation</a>
              </li>
        </ul>
  
              </li>
                <li class="menu-item menu-item--expanded">
        <a href="/docs/hosting" hreflang="en">Hosting guides</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/hosting/github-pages" hreflang="en">Github pages</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/netlify" hreflang="en">Netlify</a>
              </li>
        </ul>
  
              </li>
        </ul>
  
              </li>
        </ul>
  


  </nav>

  </div>

  </div>

      </aside>
    
    <div class="content">
        <div class="region region-content">
    <div id="block-tomefyi-page-title" class="block block-core block-page-title-block">
  
    
      
  <h1 class="page-title"><span class="field field--name-title field--type-string field--label-hidden">Static site generation</span>
</h1>


  </div>
<div id="block-mainpagecontent" class="block block-system block-system-main-block">
  
    
      
<article role="article" class="node node--type-book node--view-mode-full">

  
    

  
  <div class="node__content">
    
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p>The static site generator included with Tome uses internal request handling and concurrency to ensure that pages are exported as quickly as possible.</p>

<p>The static site generation flow works like:</p>

<ol>
	<li>The "drush tome:static" command is ran.</li>
	<li>The "tome.static" service collects all paths known to Drupal. Currently this is a combination of all routes that do not use parameters, and all entity "canonical" paths (and the paths of their translations).&nbsp;If the site uses URL language negotiation, each configured language prefix is also collected. Only entities/routes that are accessible to anonymous are exported.</li>
	<li>Paths are exported using a user-configurable concurrency, which defaults to five. This means that five paths will be processed by Drupal at a time.</li>
	<li>For each path, the script first checks if the path is a static file that can be immediately copied. This is common for pre-generated files in the files directory.</li>
	<li>If the path isn't a static file, a new process is invoked and Drupal handles the request. This is done using the "http.kernel" service. If a response with the status code 200 is returned, the content of that response is saved to the filesystem.</li>
	<li>If the response was HTML, that HTMl is parsed and assets are collected. The currently recognized assets are pager links (to support Views pagers), images, responsive images (using srcset), stylesheets, scripts, and favicons.</li>
	<li>If the response was CSS, URLs within "url(...)" are parsed as assets.</li>
	<li>All collected asset paths are then returned to the parent process, which exports&nbsp;them starting at step 3.</li>
	<li>Steps 3-8 repeat until there are no more assets to be exported.</li>
</ol>

<p>If a path that your site needs is not collected automatically, you can subscribe to the "Drupal\tome\Event\TomeEvents:COLLECT_PATHS" event, which allows you to add, remove, and replace collected paths. Additionally APIs for processing responses will be added as needed.</p>
</div>
      
  <nav id="book-navigation-1" class="book-navigation" role="navigation" aria-labelledby="book-label-1">
    
          <h2 class="visually-hidden" id="book-label-1">Book traversal links for Static site generation</h2>
      <ul class="book-pager">
              <li class="book-pager__item book-pager__item--previous">
          <a href="/docs/technical/importer" rel="prev" title="Go to previous page"><b>‹</b> Importing</a>
        </li>
                    <li class="book-pager__item book-pager__item--center">
          <a href="/docs/technical" title="Go to parent page">Up</a>
        </li>
                    <li class="book-pager__item book-pager__item--next">
          <a href="/docs/hosting" rel="next" title="Go to next page">Hosting guides <b>›</b></a>
        </li>
          </ul>
      </nav>

  </div>

</article>

  </div>

  </div>

    </div>
  </main>

  <footer>
      <div class="region region-footer">
    <div id="block-footerblock" class="block block-block-content block-block-content41a379f1-9578-43d6-9b62-977bfe857232">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p class="text-align-center"><a href="https://github.com/drupal-tome">Github</a>&nbsp;- <a href="https://www.drupal.org/project/tome">Drupal.org</a> - <a href="https://twitter.com/DrupalSAM">Twitter</a>&nbsp;- <a href="https://drupalslack.herokuapp.com">Slack (#tome)</a></p>

<p class="text-align-center">Tome is in development and likely has some bugs. Please be patient and&nbsp;respectful when reporting issues!</p>

<p class="text-align-center">This site is built with Tome! <a href="https://github.com/drupal-tome/drupal-tome.github.io">Check it out and build it locally from Github</a>.</p>
</div>
      
  </div>

  </div>

  </footer>

</div>

  </div>

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","user":{"uid":0,"permissionsHash":"9e0ede86c6c99138a3d9a8cdf7279a94909b5654a90c37a343e4f43225f06e93"}}</script>
<script src="/sites/default/files/js/js_4uwf-cPRtUiMtyUPn9rsCyG60vwXOwMnxlJAT5ATMHU.js"></script>

  </body>
</html>
