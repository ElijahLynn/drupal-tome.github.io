<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
<meta name="title" content="Hosted Drupal + Rewrites | Tome" />
<meta name="twitter:card" content="summary_large_image" />
<link rel="canonical" href="https://tome.fyi/docs/hosting/hosted-drupal-rewrites" />
<meta name="twitter:title" content="Hosted Drupal + Rewrites" />
<meta name="twitter:description" content="Some Tome users may find it useful to use Tome Static only as a caching layer for their Drupal site, serving some requests from the static export directory and others from Drupal. This is similar to how the Boost module worked, the main difference being that Tome generates all static pages before hand and Boost did so on-demand.

PHP

Here&#039;s a snippet you could add to settings.php to conditionally serve pages from your static export directory." />
<meta name="description" content="Some Tome users may find it useful to use Tome Static only as a caching layer for their Drupal site, serving some requests from the static export directory and others from Drupal. This is similar to how the Boost module worked, the main difference being that Tome generates all static pages before hand and Boost did so on-demand.

PHP

Here&#039;s a snippet you could add to settings.php to conditionally serve pages from your static export directory." />
<meta name="twitter:creator:id" content="@DrupalSAM" />
<meta name="twitter:creator" content="@DrupalSAM" />
<meta name="Generator" content="Drupal 8 (https://www.drupal.org)" />
<meta name="MobileOptimized" content="width" />
<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="/themes/custom/tomefyi/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="revision" href="/docs/hosting/hosted-drupal-rewrites" />
<link rel="prev" href="/docs/hosting/hosted-drupal-netlify" />
<link rel="up" href="/docs/hosting" />
<link rel="next" href="/docs/sub-modules" />

    <title>Hosted Drupal + Rewrites | Tome</title>
    <link rel="stylesheet" href="/sites/default/files/css/css_Q7lilNudr0lrAlTz2pWi8fh7creeU3wLBwWntb8CZLs.css?po3wbo" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_eiV7BZFSaBNMbZLhA-0DnVpCRVak_LAGdCGuU0NOkrs.css?po3wbo" media="all" />
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:900i|Rubik" media="all" />
<link rel="stylesheet" href="/sites/default/files/css/css_nS_MJliQn2kMoEe8HX1TCBkuIoTp6m8x7b_il6EUnu8.css?po3wbo" media="all" />

    
<!--[if lte IE 8]>
<script src="/sites/default/files/js/js_VtafjXmRvoUgAzqzYTA3Wrjkx9wcWhjP0G4ZnnqRamA.js"></script>
<![endif]-->

  </head>
  <body class="path-node page-node-type-book">
        <a href="#main-content" class="visually-hidden focusable skip-link">
      Skip to main content
    </a>
    
      <div class="dialog-off-canvas-main-canvas" data-off-canvas-main-canvas>
    <div class="page page-node-book">

      <header>
        <div class="region region-header">
    <div id="block-headermenu" class="block block-block-content block-block-content5e7498fd-45bc-4b54-a65d-f0f091d2096e">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><div class="header-menu">
<p><a href="https://drupal.org/project/tome">Source</a>&nbsp;• <a href="https://github.com/drupal-tome">Github</a> • <a href="/docs">Documentation</a></p>
</div>
</div>
      
  </div>
<div id="block-documentationtitle" class="block block-block-content block-block-content2db80bdd-cd46-41d9-b7b3-410644d9177f">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><div class="documentation-title">
<h1><a href="/">Tome</a></h1>
</div>
</div>
      
  </div>

  </div>

    </header>
  
  <main role="main">
    <a id="main-content" tabindex="-1"></a>

          <aside class="sidebar" role="complementary">
          <div class="region region-sidebar">
    <div id="block-expandedbooknavigation" class="block block-tfyi-book block-expanded-book-navigation">
  
    
        <nav id="book-block-menu-1" class="book-block-menu" role="navigation" aria-label="Book outline for Documentation">
    
              <a class="burger" href="#">&#9776; Navigation</a>
      <ul  class="menu burger-menu">
                    <li class="menu-item menu-item--expanded">
        <a href="/docs" hreflang="en">Documentation</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/getting-started" hreflang="en">Getting started</a>
              </li>
                <li class="menu-item">
        <a href="/docs/using-the-command-line" hreflang="en">Using the command line</a>
              </li>
                <li class="menu-item">
        <a href="/docs/module-compatibility" hreflang="en">Module compatibility</a>
              </li>
                <li class="menu-item">
        <a href="/docs/multilingual" hreflang="en">Multilingual</a>
              </li>
                <li class="menu-item menu-item--expanded">
        <a href="/docs/technical" hreflang="en">Technical documentation</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/technical/exporter" hreflang="en">Exporting</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/importer" hreflang="en">Importing</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/static" hreflang="en">Static site generation</a>
              </li>
                <li class="menu-item">
        <a href="/docs/site-settings" hreflang="en">Site specific settings</a>
              </li>
                <li class="menu-item">
        <a href="/docs/technical/docker" hreflang="en">Docker</a>
              </li>
        </ul>
  
              </li>
                <li class="menu-item menu-item--expanded">
        <a href="/docs/hosting" hreflang="en">Hosting guides</a>
                                <ul class="menu">
                    <li class="menu-item">
        <a href="/docs/hosting/github-pages" hreflang="en">Github pages</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/netlify" hreflang="en">Netlify</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/hosted-drupal-netlify" hreflang="en">Hosted Drupal + Netlify</a>
              </li>
                <li class="menu-item">
        <a href="/docs/hosting/hosted-drupal-rewrites" hreflang="en">Hosted Drupal + Rewrites</a>
              </li>
        </ul>
  
              </li>
                <li class="menu-item">
        <a href="/docs/sub-modules" hreflang="en">Using Tome Static and Tome Sync</a>
              </li>
        </ul>
  
              </li>
        </ul>
  


  </nav>

  </div>

  </div>

      </aside>
    
    <div class="content">
        <div class="region region-content">
    <div id="block-tomefyi-page-title" class="block block-core block-page-title-block">
  
    
      
  <h1 class="page-title"><span class="field field--name-title field--type-string field--label-hidden">Hosted Drupal + Rewrites</span>
</h1>


  </div>
<div id="block-mainpagecontent" class="block block-system block-system-main-block">
  
    
      
<article role="article" class="node node--type-book node--view-mode-full">

  
    

  
  <div class="node__content">
    
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p>Some Tome users may find it useful to use Tome Static only as a caching layer for their Drupal site, serving some requests from the static export directory and others from Drupal. This is similar to how the <a href="https://drupal.org/project/boost">Boost</a> module worked, the main difference being that Tome generates all static pages before hand and Boost did so on-demand.</p>

<h2>PHP</h2>

<p>Here's a snippet you could add to settings.php to conditionally serve pages from your static export directory.</p>

<p>Note that this code is just an example and needs to be reviewed and tested before production use:</p>

<pre>
<code class="language-php">// Add this code to the bottom of settings.php
$path = parse_url($_SERVER['REQUEST_URI'], PHP_URL_PATH);
// Check if the incoming path is for a user-facing path.
if (strpos($path, '/admin') !== 0 &amp;&amp; !preg_match('|^/node/.*/edit$|', $path)) {
  $path = realpath('../html' . $path);
  if (is_dir($path)) {
    $path .= '/index.html';
  }
  // HTML pages are updated often and should have an expiry.
  if (pathinfo($path, PATHINFO_EXTENSION) === 'html') {
    header('Cache-Control: public, max-age=600');
  }
  // If the file exists and is safe to serve, do so.
  if (strpos($path, realpath('../html')) === 0 &amp;&amp; file_exists($path)) {
    echo file_get_contents($path);
    die;
  }
  // Fallback to a simple 404.
  header('HTTP/1.0 404 Not Found');
  echo 'File not found.';
  die;
}
</code></pre>

<h2>Apache</h2>

<p>Here's a snippet that should work with .htaccess files. The "html" folder needs to be in the same directory level as your Apache document root as rewrites to parent directories (i.e. ../html) are not allowed.</p>

<p>Note that this code is just an example and needs to be reviewed and tested before production use:</p>

<pre>
<code class="language-apache">RewriteEngine On
RewriteRule !^(admin.*|node/.*/edit) /html/$1
</code></pre>

<p>If you find bugs in these examples, or want to add more, please file an issue at <a href="https://github.com/drupal-tome/drupal-tome.github.io">drupal-tome/drupal-tome.github.io</a>&nbsp;and let me know!</p>
</div>
      
  <nav id="book-navigation-1" class="book-navigation" role="navigation" aria-labelledby="book-label-1">
    
          <h2 class="visually-hidden" id="book-label-1">Book traversal links for Hosted Drupal + Rewrites</h2>
      <ul class="book-pager">
              <li class="book-pager__item book-pager__item--previous">
          <a href="/docs/hosting/hosted-drupal-netlify" rel="prev" title="Go to previous page"><b>‹</b> Hosted Drupal + Netlify</a>
        </li>
                    <li class="book-pager__item book-pager__item--center">
          <a href="/docs/hosting" title="Go to parent page">Up</a>
        </li>
                    <li class="book-pager__item book-pager__item--next">
          <a href="/docs/sub-modules" rel="next" title="Go to next page">Using Tome Static and Tome Sync <b>›</b></a>
        </li>
          </ul>
      </nav>

  </div>

</article>

  </div>

  </div>

    </div>
  </main>

  <footer>
      <div class="region region-footer">
    <div id="block-footerblock" class="block block-block-content block-block-content41a379f1-9578-43d6-9b62-977bfe857232">
  
    
      
            <div class="clearfix text-formatted field field--name-body field--type-text-with-summary field--label-hidden field__item"><p class="text-align-center"><a href="https://github.com/drupal-tome">Github</a>&nbsp;- <a href="https://www.drupal.org/project/tome">Drupal.org</a> - <a href="https://twitter.com/DrupalSAM">Twitter</a>&nbsp;- <a href="https://drupalslack.herokuapp.com">Slack (#tome)</a></p>

<p class="text-align-center">Tome is in development and likely has some bugs. Please be patient and&nbsp;respectful when reporting issues!</p>

<p class="text-align-center">This site is built with Tome! <a href="https://github.com/drupal-tome/drupal-tome.github.io">Check it out and build it locally from Github</a>.</p>
</div>
      
  </div>

  </div>

  </footer>

</div>

  </div>

    
    <script type="application/json" data-drupal-selector="drupal-settings-json">{"path":{"baseUrl":"\/","scriptPath":null,"pathPrefix":"","currentPath":"","currentPathIsAdmin":false,"isFront":false,"currentLanguage":"en"},"pluralDelimiter":"\u0003","user":{"uid":0,"permissionsHash":"a62298ae27aa85541fd5873a1c59343404d12bd630acaa3cb078ed01c5db6335"}}</script>
<script src="/sites/default/files/js/js_q3z8PIgethlki2eZSsjzuY66RQ11LgJlLY8Zw0Q9yNw.js"></script>

  </body>
</html>
